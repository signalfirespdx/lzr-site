import{D as d}from"./web-Du1_VWYB.js";function N(n,r){const t={"=":"===","!=":"!==",">":">","<":"<",">=":">=","<=":"<=",IN:"IN"},s=Object.keys(t).map(e=>e.replace(/([=<>!])/g,"\\$1")).join("|"),p=new RegExp(`^\\s*([a-zA-Z_][a-zA-Z0-9_]*)\\s*(${s})\\s*(.+?)\\s*$`,"i"),a=r.split(/\s+(AND|OR)\s+/i),i=[],c=[];for(let e=0;e<a.length;e++)if(e%2===0){const l=a[e].match(p);if(!l)throw new Error(`Invalid filter expression: "${a[e]}"`);let[,$,f,g]=l;f=f.toUpperCase();let u;if(f==="IN")u=g.trim().replace(/^\((.*)\)$/,"$1").split(/\s*,\s*/).map(m=>JSON.parse(m.replace(/^'(.*)'$/,'"$1"'))).includes(n[$]);else{const h=t[f],m=JSON.parse(g.replace(/^'(.+)'$/,'"$1"'));u=Function("obj",`return obj["${$}"] ${h} ${JSON.stringify(m)};`)(n)}i.push(u)}else c.push(a[e].toUpperCase());let o=i[0];for(let e=0;e<c.length;e++)c[e]==="AND"?o=o&&i[e+1]:c[e]==="OR"&&(o=o||i[e+1]);return o}function O(n){return n.split(",").map(r=>{const t=r.trim();return t.startsWith("-")?{field:t.slice(1),direction:"desc"}:{field:t,direction:"asc"}})}async function R(n,r){return Promise.all(Object.entries(n).map(async([t,s])=>(await s()).frontmatter)).then(t=>{if(r?.filter&&(t=t.filter(s=>N(s,r.filter))),r?.sort){const s=O(r.sort);t.sort((p,a)=>{for(const{field:i,direction:c}of s){const o=p[i],e=a[i];if(o===e)continue;const l=o>e?1:-1;return c==="asc"?l:-l}return 0})}return t})}function j(n,r){const[t]=d(n,s=>R(s,r));return[t]}export{j as c};
